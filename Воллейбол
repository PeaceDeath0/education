#include <iostream>
#include <fstream>
#include <string>
#include <vector>

using namespace std;

// Расстановка команд до матча
int team1[4] = {1, 5, 10, 8};
int team2[4] = {12, 8, 9, 1};

// Переменная для хранения текущего счета матча
vector<pair<int, int>> score = {{0, 0}};

// Переменная для хранения текущей расстановки команды
int* current_team = team1;

// Функция для отображения текущей расстановки команды на консоли
void print_team() {
    cout << "Team: ";
    for (int i = 0; i < 4; i++) {
        cout << current_team[i] << " ";
    }
    cout << endl;
}

// Функция для изменения расстановки команды в зависимости от победителя последнего розыгрыша
void change_team(bool is_team1_win) {
    if (is_team1_win) {
        current_team = team1;
    } else {
        current_team = team2;
    }
    print_team();
}

// Функция для изменения счета матча по результатам одного розыгрыша
void change_score(char action, int player) {
    // Проверяем, верный ли номер игрока для текущей расстановки команды
    bool is_player_valid = false;
    for (int i = 0; i < 4; i++) {
        if (current_team[i] == player) {
            is_player_valid = true;
            break;
        }
    }
    if (!is_player_valid) {
        return;
    }

    // Обновляем счет матча
    if (action == 'A') { // Атака
        score.back().first++;
    } else if (action == 'B') { // Блок
        score.back().second++;
    } else if (action == 'P') { // Подача
        // Ничего не делаем
    } else if (action == 'O') { // Ошибка
        score.back().second++;
    }

    // Проверяем, нужно ли начать новую партию
    if (score.back().first >= 25 && score.back().first - score.back().second >= 2) {
        score.push_back(make_pair(0, 0));
    }

    // Выводим текущий счет матча на консоль
    cout << "Score: " << score.size() << " (" << score.back().first << ") - " 
    << score.size() - 1 << " (" << score.back().second << ")" << endl;
}

// Функция для замены игрока
void replace_player(int leaving_player, int entering_player) {
    // Находим индекс игрока, который покидает площадку
    int leaving_player_index = -1;
    for (int i = 0; i < 4; i++) {
        if (current_team[i] == leaving_player) {
            leaving_player_index = i;
            break;
        }
    }
    if (leaving_player_index == -1) {
        return;
    }

    // Заменяем игрока
    current_team[leaving_player_index] = entering_player;
    print_team();
}

int main() {
    // Начало матча, вывод основной информации на консоль
    cout << "Starting match" << endl;
    cout << "Team 1: "; print_team();
    cout << "Team 2: "; print_team();
    cout << "Score: 1 (0) - 0 (0)" << endl;

    // Открываем файл для записи логов матча
    ofstream log_file;
    log_file.open("logs.txt");

    // Обрабатываем действия игроков во время матча
    while (true) {
        char action;
        int player;
        cout << "Enter action and player number (ex. \"A 10\"): ";
        cin >> action >> player;

        // Записываем действие в лог-файл
        log_file << action << " " << player << endl;

        // Обрабатываем действие игрока
        if (action == 'A' || action == 'B' || action == 'P' || action == 'O') {
            change_score(action, player);
        } else if (action == 'R') { // Замена игрока
            int entering_player;
            cout << "Enter entering player number: ";
            cin >> entering_player;
            replace_player(player, entering_player);
            log_file << "R " << player << " " << entering_player << endl;
        }

        // Проверяем, нужно ли закончить матч
        if (score.size() > 3 || (score.size() == 3 && (score.back().first >= 15 || score.back().second >= 15))) {
            cout << "Match is over!" << endl;
            // Выводим окончательный счет матча на консоль
            cout << "Final score: " << score.size() - 1 << " - " << score.back().second << endl;
            // Записываем окончательный счет матча в файл
            ofstream db_file("db.txt", i
